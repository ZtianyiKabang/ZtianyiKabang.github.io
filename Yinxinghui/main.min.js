var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Game=function(t){function e(){var e=t.call(this)||this;return e.status=!1,e.point_arr=[],e.arr=[],e.isBreak=!1,e.isFirst=!1,e.count=0,e.once(egret.Event.ADDED_TO_STAGE,e.createView,e),e.line=new egret.Shape,e.addChild(e.line),e}return __extends(e,t),e.prototype.createView=function(){var t=new egret.Bitmap(RES.getRes("game_bg_jpg"));this.addChild(t);var e=new egret.Bitmap(RES.getRes("share_png"));e.x=547,this.addChild(e),this.game_hint=new egret.Bitmap(RES.getRes("game_hint_png")),this.addChild(this.game_hint),this.game_hint.x=215,this.game_hint.y=738,this.drawPoint()},e.prototype.drawPoint=function(){for(var t=[226,381,350,227,388],e=[402,409,484,578,578],i=0;5>i;i++){var s=new egret.Bitmap(RES.getRes("point_png"));this.addChild(s),s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.scaleX=s.scaleY=1.2,s.index=i,s.isAttract=!1,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this.arr.push(s),this.arr[i].x=t[i],this.arr[i].y=e[i]}this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this)},e.prototype.drawLine=function(){var t=this.line;this.addChild(t),t.graphics.clear(),t.graphics.lineStyle(6,9358289),t.graphics.moveTo(this.startX,this.startY),this.pointDistance(),t.graphics.lineTo(this.pointX,this.pointY),t.graphics.endFill(),this.lineRecord()},e.prototype.mouseDown=function(t){this.status=!0,1==this.isFirst?this.mouseMove(t):(this.startX=t.currentTarget.x,this.startY=t.currentTarget.y),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this),this.currentPoint2=t.currentTarget},e.prototype.mouseMove=function(t){1==this.status&&(this.pointX=t.stageX,this.pointY=t.stageY,this.drawLine())},e.prototype.mouseUp=function(t){this.status=!1,this.count>1&&(this.isBreak=!0,this.lastX=this.startX,this.lastY=this.startY,this.line.graphics.clear())},e.prototype.pointDistance=function(){for(var t=0;t<this.arr.length;t++){var e=this.pointX-this.arr[t].x,i=this.pointY-this.arr[t].y,s=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));0==this.arr[t].isAttract&&(20>=s?(this.arr[t].isAttract=!0,this.pointX=this.arr[t].x,this.pointY=this.arr[t].y):this.arr[t].isAttract=!1)}},e.prototype.lineRecord=function(){for(var t=0;t<this.arr.length;t++)if(this.pointX==this.arr[t].x&&this.pointY==this.arr[t].y&&(this.startX!=this.pointX||this.startY!=this.pointY)){var e=new egret.Shape;this.addChild(e),e.graphics.lineStyle(6,9358289),1==this.isBreak&&(this.isBreak=!1,e.graphics.moveTo(this.lastX,this.lastY),e.graphics.lineTo(this.startX,this.startY),this.lastX=this.startX,this.lastY=this.startY),e.graphics.moveTo(this.startX,this.startY),e.graphics.lineTo(this.pointX,this.pointY),0==this.point_arr.length&&(this.isFirst=!0,this.firstX=this.startX,this.firstY=this.startY,this.point_arr.push(this.currentPoint2.index)),this.point_arr.push(this.arr[t].index),this.startX=this.pointX,this.startY=this.pointY,this.count++}if(5==this.point_arr.length){var i=this.point_arr[4],s=new egret.Shape;this.addChild(s),s.graphics.clear(),s.graphics.lineStyle(6,9358289),s.graphics.moveTo(this.arr[i].x,this.arr[i].y),s.graphics.lineTo(this.firstX,this.firstY),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this),this.switchScene()}},e.prototype.switchScene=function(){egret.Tween.get(this.game_hint).to({alpha:0,texture:RES.getRes("game_title_png")},400).to({alpha:1},400);var t=new egret.Bitmap(RES.getRes("go_on_png"));this.addChild(t),t.x=121,t.y=830,t.alpha=0,egret.Tween.get(t).to({alpha:1},400),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onceMore,this);var e=new egret.Bitmap(RES.getRes("share_btn_png"));this.addChild(e),e.x=357,e.y=830,e.alpha=0,egret.Tween.get(e).to({alpha:1},400),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shareHint,this);for(var i=[[0,2,3,1,4],[0,4,1,3,2],[0,1,2,3,4],[0,4,3,2,1],[0,1,4,2,3],[0,3,2,4,1],[0,2,1,3,4],[0,4,3,1,2],[0,1,3,4,2],[0,2,4,3,1],[0,2,1,4,3],[0,3,4,1,2],[0,1,4,3,2],[0,2,3,4,1],[0,2,4,1,3],[0,3,1,4,2],[0,1,3,2,4],[0,4,2,3,1],[0,3,2,1,4],[0,4,1,2,3],[0,3,1,2,4],[0,4,2,1,3],[0,1,2,4,3],[0,3,4,2,1]],s=0;s<i.length;s++)for(var r=0;r<i[s].length;r++){var a=i[s],h=i[s][0];if(a.push(h),a.splice(0,1),a.toString()==this.point_arr.toString()){var n=Math.floor(s/2)+1;if(0==s||1==s){var o=new egret.Bitmap(RES.getRes("map_1_1_png"));this.addChild(o),o.x=15,o.y=149,egret.Tween.get(o,{loop:!0}).to({texture:RES.getRes("map_1_2_png")},400).to({texture:RES.getRes("map_1_3_png")},400).wait(400).to({texture:RES.getRes("map_1_2_png")},400).to({texture:RES.getRes("map_1_1_png")},400),o.alpha=0,egret.Tween.get(o).to({alpha:1},400);var g=new egret.Bitmap(RES.getRes("title_1_png"));g.x=318,g.y=464,g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.alpha=0,egret.Tween.get(g).to({alpha:1},400),this.addChild(g)}else{var p=new Map("map_"+n+"_1_png","map_"+n+"_2_png","title_"+n+"_png",318,464);this.addChild(p),p.alpha=0,egret.Tween.get(p).to({alpha:1},400)}}}},e.prototype.onceMore=function(t){this.dispatchEventWith("onceMore"),t.currentTarget.touchEnabled=!1,t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onceMore,this)},e.prototype.shareHint=function(t){var e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawRect(0,0,640,1030),e.graphics.endFill(),this.addChild(e),e.alpha=.8,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.closePage,this),this.share_hint=new egret.Bitmap(RES.getRes("share_hint_png")),this.addChild(this.share_hint),this.share_hint.x=237,this.share_hint.y=74},e.prototype.closePage=function(t){this.removeChild(t.currentTarget),this.removeChild(this.share_hint)},e}(egret.DisplayObjectContainer);__reflect(Game.prototype,"Game");var GameTest=function(t){function e(){var e=t.call(this)||this;return e.status=!1,e.point_arr=[],e.arr=[],e.isBreak=!1,e.isFirst=!1,e.once(egret.Event.ADDED_TO_STAGE,e.createView,e),e.line=new egret.Shape,e.addChild(e.line),e}return __extends(e,t),e.prototype.createView=function(){var t=new egret.Bitmap(RES.getRes("game_bg_jpg"));this.addChild(t);var e=new egret.Bitmap(RES.getRes("share_png"));e.x=547,this.addChild(e),this.game_hint=new egret.Bitmap(RES.getRes("game_hint_png")),this.addChild(this.game_hint),this.game_hint.x=215,this.game_hint.y=738,this.drawPoint()},e.prototype.drawPoint=function(){for(var t=[226,381,350,227,388],e=[402,409,484,578,578],i=0;5>i;i++){var s=new egret.Bitmap(RES.getRes("point_png"));this.addChild(s),s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.scaleX=s.scaleY=1.5,s.index=i,s.isAttract=!1,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this.arr.push(s),this.arr[i].x=t[i],this.arr[i].y=e[i]}this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this)},e.prototype.drawLine=function(){var t=this.line;this.addChild(t),t.graphics.clear(),t.graphics.lineStyle(6,9358289),t.graphics.moveTo(this.startX,this.startY),this.pointDistance(),t.graphics.lineTo(this.pointX,this.pointY),t.graphics.endFill(),this.lineRecord()},e.prototype.mouseDown=function(t){this.status=!0,1==this.isFirst?this.mouseMove(t):(this.startX=t.currentTarget.x,this.startY=t.currentTarget.y),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this),this.currentPoint2=t.currentTarget},e.prototype.mouseMove=function(t){1==this.status&&(this.pointX=t.stageX,this.pointY=t.stageY,this.drawLine())},e.prototype.mouseUp=function(t){this.status=!1;for(var e=0;e<this.arr.length;e++){var i=this.pointX-this.arr[e].x,s=this.pointY-this.arr[e].y,r=Math.sqrt(Math.pow(i,2)+Math.pow(s,2));r>20&&(this.isBreak=!0,this.lastX=this.startX,this.lastY=this.startY,this.line.graphics.clear())}},e.prototype.pointDistance=function(){for(var t=0;t<this.arr.length;t++){var e=this.pointX-this.arr[t].x,i=this.pointY-this.arr[t].y,s=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));0==this.arr[t].isAttract&&20>=s&&(this.arr[t].isAttract=!0,this.pointX=this.arr[t].x,this.pointY=this.arr[t].y)}},e.prototype.lineRecord=function(){for(var t=0;t<this.arr.length;t++)if(0==this.point_arr.length&&(this.isFirst=!0,this.firstX=this.startX,this.firstY=this.startY,this.point_arr.push(this.currentPoint2.index),1==this.isBreak&&(this.isBreak=!1,e.graphics.moveTo(this.lastX,this.lastY),e.graphics.lineTo(this.startX,this.startY),this.lastX=this.startX,this.lastY=this.startY)),this.pointX==this.arr[t].x&&this.pointY==this.arr[t].y&&(this.startX!=this.pointX||this.startY!=this.pointY)){var e=new egret.Shape;this.addChild(e),e.graphics.lineStyle(6,9358289),1==this.isBreak&&(this.isBreak=!1,e.graphics.moveTo(this.lastX,this.lastY),e.graphics.lineTo(this.startX,this.startY),this.lastX=this.startX,this.lastY=this.startY),e.graphics.moveTo(this.startX,this.startY),e.graphics.lineTo(this.pointX,this.pointY),this.point_arr.push(t),this.startX=this.pointX,this.startY=this.pointY,console.log(this.point_arr)}if(5==this.point_arr.length){var i=this.point_arr[4],s=new egret.Shape;this.addChild(s),s.graphics.clear(),s.graphics.lineStyle(6,9358289),s.graphics.moveTo(this.arr[i].x,this.arr[i].y),s.graphics.lineTo(this.firstX,this.firstY),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this);var r=new egret.Shape;r.graphics.beginFill(16777215),r.graphics.drawRect(0,0,606,590),r.graphics.endFill(),this.addChild(r),r.alpha=0,r.touchEnabled=!0,this.switchScene()}},e.prototype.switchScene=function(){egret.Tween.get(this.game_hint).to({alpha:0,texture:RES.getRes("game_title_png")},400).to({alpha:1},400);var t=new egret.Bitmap(RES.getRes("go_on_png"));this.addChild(t),t.x=121,t.y=830,t.alpha=0,egret.Tween.get(t).to({alpha:1},400),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onceMore,this);var e=new egret.Bitmap(RES.getRes("share_btn_png"));this.addChild(e),e.x=357,e.y=830,e.alpha=0,egret.Tween.get(e).to({alpha:1},400),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shareHint,this);for(var i=[[0,2,3,1,4],[0,4,1,3,2],[0,1,2,3,4],[0,4,3,2,1],[0,1,4,2,3],[0,3,2,4,1],[0,2,1,3,4],[0,4,3,1,2],[0,1,3,4,2],[0,2,4,3,1],[0,2,1,4,3],[0,3,4,1,2],[0,1,4,3,2],[0,2,3,4,1],[0,2,4,1,3],[0,3,1,4,2],[0,1,3,2,4],[0,4,2,3,1],[0,3,2,1,4],[0,4,1,2,3],[0,3,1,2,4],[0,4,2,1,3],[0,1,2,4,3],[0,3,4,2,1]],s=0;s<i.length;s++)for(var r=0;r<i[s].length;r++){var a=i[s],h=i[s][0];if(a.push(h),a.splice(0,1),a.toString()==this.point_arr.toString()){var n=Math.floor(s/2)+1;if(0==s||1==s){var o=new egret.Bitmap(RES.getRes("map_1_1_png"));this.addChild(o),o.x=15,o.y=149,egret.Tween.get(o,{loop:!0}).to({texture:RES.getRes("map_1_2_png")},400).to({texture:RES.getRes("map_1_3_png")},400).wait(400).to({texture:RES.getRes("map_1_2_png")},400).to({texture:RES.getRes("map_1_1_png")},400),o.alpha=0,egret.Tween.get(o).to({alpha:1},400);var g=new egret.Bitmap(RES.getRes("title_1_png"));g.x=318,g.y=464,g.anchorOffsetX=g.width/2,g.anchorOffsetY=g.height/2,g.alpha=0,egret.Tween.get(g).to({alpha:1},400),this.addChild(g)}else{var p=new Map("map_"+n+"_1_png","map_"+n+"_2_png","title_"+n+"_png",318,464);this.addChild(p),p.alpha=0,egret.Tween.get(p).to({alpha:1},400)}}}},e.prototype.onceMore=function(t){this.dispatchEventWith("onceMore"),t.currentTarget.touchEnabled=!1,t.currentTarget.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onceMore,this)},e.prototype.shareHint=function(t){var e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawRect(0,0,640,1030),e.graphics.endFill(),this.addChild(e),e.alpha=.8,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.closePage,this),this.share_hint=new egret.Bitmap(RES.getRes("share_hint_png")),this.addChild(this.share_hint),this.share_hint.x=237,this.share_hint.y=74},e.prototype.closePage=function(t){this.removeChild(t.currentTarget),this.removeChild(this.share_hint)},e}(egret.DisplayObjectContainer);__reflect(GameTest.prototype,"GameTest");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){var t=new egret.Bitmap(RES.getRes("loading_jpg"));this.addChild(t);var e=new egret.Bitmap(RES.getRes("loading_icon_png"));this.addChild(e),e.x=227,e.y=402,egret.Tween.get(e,{loop:!0}).to({y:372},1800,egret.Ease.quadOut).to({y:402},1800,egret.Ease.quadOut),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.textColor=16777215,this.textField.y=666,this.textField.width=640,this.textField.height=200,this.textField.size=48,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text=Math.floor(t/e*100)+"%"},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.groupName?(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene()):"loading"==t.groupName&&(this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.loadGroup("preload"))},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.createGameScene=function(){startPlay(),this.startPage()},e.prototype.startPage=function(){this.currengPage&&(egret.Tween.get(this.currengPage).to({alpha:0},500).call(function(t){t.parent.removeChild(t)},this,[this.currengPage]),this.currengPage=null),this.currengPage=new Start,this.addChild(this.currengPage),this.currengPage.alpha=0,egret.Tween.get(this.currengPage).to({alpha:1},500),this.currengPage.addEventListener("startGame",this.gamePage,this)},e.prototype.gamePage=function(){this.currengPage&&(egret.Tween.get(this.currengPage).to({alpha:0},500).call(function(t){t.parent.removeChild(t)},this,[this.currengPage]),this.currengPage=null),this.currengPage=new GameTest,this.addChild(this.currengPage),this.currengPage.alpha=0,egret.Tween.get(this.currengPage).to({alpha:1},500),this.currengPage.addEventListener("onceMore",this.gamePage,this)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Map=function(t){function e(e,i,s,r,a){var h=t.call(this)||this,n=new egret.Bitmap(RES.getRes(e));n.x=15,n.y=149,h.addChild(n),egret.Tween.get(n,{loop:!0}).wait(200).to({texture:RES.getRes(i)},400).to({texture:RES.getRes(e)},400);var o=new egret.Bitmap(RES.getRes(s));return o.x=r,o.y=a,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,h.addChild(o),h}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(Map.prototype,"Map");var Start=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.bg=this.initBitMap("start_bg_jpg",0,0),this.share=this.initBitMap("share_png",547,-200),egret.Tween.get(this.share).to({y:0},800,egret.Ease.quadOut),this.title=this.initBitMap("title_png",110,176),this.icon=this.initBitMap("icon_png",149,344),egret.Tween.get(this.icon,{loop:!0}).to({y:294},2e3,egret.Ease.quadOut).to({y:344},1800,egret.Ease.quadOut),this.icon.touchEnabled=!0,this.icon.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startGame,this),this.hint=this.initBitMap("hint_png",215,1051),this.hint.alpha=0,egret.Tween.get(this.hint).to({alpha:1,y:851},1e3,egret.Ease.quadOut)},e.prototype.initBitMap=function(t,e,i){var s=new egret.Bitmap(RES.getRes(t));return s.x=e,s.y=i,this.addChild(s),s},e.prototype.startGame=function(t){this.dispatchEventWith("startGame"),this.icon.touchEnabled=!1,this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startGame,this)},e}(egret.DisplayObjectContainer);__reflect(Start.prototype,"Start");